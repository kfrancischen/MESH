
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Kaifeng Chen">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.2, mkdocs-material-1.5.1">
    
    
      
        <title>Base Class - MESH documentation</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-8d06ab29f4.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../.." title="MESH documentation" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lua API
                </span>
              
            
            Base Class
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/kfrancischen/MESH" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      kfrancischen/MESH
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    MESH documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/kfrancischen/MESH" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      kfrancischen/MESH
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/" title="Equations & Features" class="md-nav__link">
      Equations & Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Lua API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Lua API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
    <a href="./" title="Base Class" class="md-nav__link md-nav__link--active">
      Base Class
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../planar/" title="SimulationPlanar" class="md-nav__link">
      SimulationPlanar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../grating/" title="SimulationGrating" class="md-nav__link">
      SimulationGrating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pattern/" title="SimulationPattern" class="md-nav__link">
      SimulationPattern
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      C++ API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        C++ API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../C++API/classAndFunction/" title="Classes and Functions" class="md-nav__link">
      Classes and Functions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/tutorial/" title="Tutorial Example" class="md-nav__link">
      Tutorial Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/planeFarField/" title="Single Plane Far-field" class="md-nav__link">
      Single Plane Far-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/planeNearField/" title="Two Planes Near-field" class="md-nav__link">
      Two Planes Near-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/anisotropic/" title="Anisotropic Material Near-field" class="md-nav__link">
      Anisotropic Material Near-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/iterate/" title="Iterate Over Gaps Near-field" class="md-nav__link">
      Iterate Over Gaps Near-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/gratingNearField/" title="Two Gratings Near-field" class="md-nav__link">
      Two Gratings Near-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/rectangleNearField/" title="Two Rectangle Patterns Near-field" class="md-nav__link">
      Two Rectangle Patterns Near-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/mixedNearField/" title="Mixed Patterns Near-field" class="md-nav__link">
      Mixed Patterns Near-field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/MPI/" title="MPI Example" class="md-nav__link">
      MPI Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../develop/" title="Developer" class="md-nav__link">
      Developer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Base Class</h1>
                
                <p>MESH is written in an inheritance manner, so most of the functions in the base class can be directly accessed by subclasses. Usage of MESH involves writing a Lua script to call into various parts of MESH. Here we describe all of the MESH base class functions that can be called within the Lua environment.</p>
<p>For which functions can be called for a given geometry, please read the pages <a href="../planar/">SimulationPlanar</a>, <a href="../grating/">SimulationGrating</a> and <a href="../pattern/">SimulationPattern</a> for the geometries you are simulating.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The base class is just a wrapper for most of the functions, but it cannot be initiated in a Lua script. The only instances that can be initiated are the classes corresponding to different dimensions.</p>
</div>
<div class="codehilite"><pre><span></span><span class="n">AddMaterial</span><span class="p">(</span><span class="n">material</span> <span class="n">name</span><span class="p">,</span> <span class="n">input</span> <span class="n">file</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>material name: [string], the name of the material added to the simulation. Such name is unique and if there already exists a material with the same name, an error message will be printed out.</li>
<li>input file: [string], a file that contains the dielectric properties of the corresponding material. For scalar dielectric, the input file should be formatted as  a list of      <br />
<code>omega eps_r eps_i</code>  <br />
For diagonal dielectric, the format is a list of      <br />
<code>omega eps_xx_r eps_xx_i eps_yy_r eps_yy_i eps_zz_r  eps_zz_i</code>  <br />
For tensor dielectric, the format is a list of   <br />
<code>omega eps_xx_r eps_xx_i eps_xy_r eps_xy_i eps_yx_r eps_yx_i eps_yy_r eps_yy_i eps_zz_r  eps_zz_i</code>     </li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: The omega needs to be aligned for all the materials in the simulation.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetMaterial</span><span class="p">(</span><span class="n">material</span> <span class="n">name</span><span class="p">,</span> <span class="n">new</span> <span class="n">epsilon</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>material name: [string], the name of the material whose epsilon will be changed. This material should already exist in the simulation (by <code>AddMaterial</code>), otherwise an error will be printed out.</li>
<li>new epsilon: [nested table], the length equals the number of omega, and per row is the epsilon values with the same format as the input of <code>AddMaterial</code> function. i.e. for scalar case the length will be <script type="math/tex">2</script>, for diagonal case the length is <script type="math/tex">6</script> and for tensor case the length is <script type="math/tex">10</script>.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">AddLayer</span><span class="p">(</span><span class="n">layer</span> <span class="n">name</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">material</span> <span class="n">name</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>layer name: [string], the name of the layer. Similarly, the names for layers are unique, and if such name already exists in the simulation, an error message will be printed out.</li>
<li>thickness: [double], the thickness of the new layer in SI unit.</li>
<li>material name: [string], the material that is used as the background of the layer. This material should already exist in the simulation (by <code>AddMaterial</code>), otherwise an error message will be printed out.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this new added layer will be placed on top of all the previous layers.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetLayer</span><span class="p">(</span><span class="n">layer</span> <span class="n">name</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">material</span> <span class="n">name</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>layer name: [string], the layer whose thickness and background will be changed. Such layer needs to already exist in the simulation, otherwise an error message will be printed out.</li>
<li>thickness: [double], the new thickness of the layer.</li>
<li>material name: [string], the material for the background of the layer. If such material does not exist, an error message will be printed out.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetLayerThickness</span><span class="p">(</span><span class="n">layer</span> <span class="n">name</span><span class="p">,</span> <span class="n">thickness</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>layer name: [string],  the layer whose thickness will be changed. Such layer needs to already exist in the simulation, otherwise an error message will be printed out.</li>
<li>thickness: [double], the new thickness of the layer.</li>
</ol>
</li>
<li>
<p>Output: None  </p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">AddLayerCopy</span><span class="p">(</span><span class="n">new</span> <span class="n">layer</span> <span class="n">name</span><span class="p">,</span> <span class="n">original</span> <span class="n">layer</span> <span class="n">name</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>new layer name: [string], the new layer that is copied from the original layer.  Such name cannot already exist in the simulation, otherwise an error message will be printed out.</li>
<li>original layer name: [string], the original layer from whom everything is copied. If this layer does not exist in the simulation, an error will be printed out.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function only copies the structure information, for example any pattern of the original layer, but does not copy any thermal information. For example, even the original layer is set as a source, the copied layer is still not a source. In addition, this new added layer will be placed on top of all the previous layers.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">DeleteLayer</span><span class="p">(</span><span class="n">layer</span> <span class="n">name</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>layer name: [string], the name of the layer that will be deleted. Such layer should already be in the system, otherwise an error will be printed out.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetPeriodicity</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>p1: [double], the periodicity in <script type="math/tex">x</script> direction in SI unit.</li>
<li>p2: [double, optional for grating geometry], the periodicity in <script type="math/tex">y</script> direction in SI unit.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetGx</span><span class="p">(</span><span class="n">nGx</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>nGx: [int], the number of positive Fourier components in <script type="math/tex">x</script> direction. The total number of G in <script type="math/tex">x</script> direction is thus 2nGx + 1.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetGy</span><span class="p">(</span><span class="n">nGy</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>nGy: [int], the number of positive Fourier components in <script type="math/tex">y</script> direction. The total number of G in <script type="math/tex">y</script> direction is thus 2nGy + 1.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetSourceLayer</span><span class="p">(</span><span class="n">layer</span> <span class="n">name</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>layer name: [string], the name of the layer that is designated as the source layer. Such layer should already exist in the system, otherwise an error will be printed out.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: a system can have more than <script type="math/tex">1</script> source layers.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetProbeLayer</span><span class="p">(</span><span class="n">layer</span> <span class="n">name</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>layer name: [string], the name of the layer that is designated as the probe layer of the flux. Such layer should already exist in the system, otherwise an error will be printed out.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: a system can have only one probe layer. Setting another layer as the probe layer will overwrite the previous one. In addition, the source layer should be above all the source layers in the real geometry.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetThread</span><span class="p">(</span><span class="n">nthread</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>nthreads: [int], number of threads used in OpenMP.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>Note: this function only works in an OpenMP setup.</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetKxIntegral</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="kr">end</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>points: [int], number of points in the integration.</li>
<li>end: [double, optional for grating and pattern geometries], the end of the integral over <script type="math/tex">k_x</script>. This end should be a normalized number with respect to <script type="math/tex">\omega/c</script>.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function is essentially doing
<script type="math/tex; mode=display">\int_{-\text{end}\cdot \omega/c}^{\text{end}\cdot \omega/c}dk_x</script> where the integral is evaluated as a summation of <code>points</code> points. In the case when <code>end</code> is not given, the lower and upper bounds of the integral will be <script type="math/tex">\pm G_x/2</script>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetKyIntegral</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="kr">end</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>points: [int], number of points in the integration.</li>
<li>end: [double, optional for pattern geometries], the end of the integral over <script type="math/tex">k_y</script>. This end should be a normalized number with respect to <script type="math/tex">\omega/c</script>.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function is essentially doing
<script type="math/tex; mode=display">\int_{-\text{end}\cdot \omega/c}^{\text{end}\cdot \omega/c}dk_y</script> where the integral is evaluated as a summation of <code>points</code> points. In the case when <code>end</code> is not given, the lower and upper bounds of the integral will be <script type="math/tex">\pm G_y/2</script>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetKxIntegralSym</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="kr">end</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>points: [int], number of points in the integration.</li>
<li>end: [double, optional for grating and pattern geometries], the end of the integral over <script type="math/tex">k_x</script>. This end should be a normalized number with respect to <script type="math/tex">\omega/c</script>.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function is essentially doing
<script type="math/tex; mode=display">2\times \int_{0}^{\text{end}\cdot \omega/c}dk_x</script> where the integral is evaluated as a summation of <code>points</code> points. In the case when <code>end</code> is not given, the upper bound of the integral will be <script type="math/tex">G_x/2</script>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SetKyIntegralSym</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="kr">end</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>points: [int], number of points in the integration.</li>
<li>end: [double, optional for pattern geometries], the end of the integral over <script type="math/tex">k_y</script>. This end should be a normalized number with respect to <script type="math/tex">\omega/c</script>.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function is essentially doing
<script type="math/tex; mode=display">2\times \int_{0}^{\text{end}\cdot \omega/c}dk_y</script> where the integral is evaluated as a summation of <code>points</code> points. In the case when <code>end</code> is not given, the upper bound of the integral will be <script type="math/tex">G_y/2</script>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">InitSimulation</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Note: this function builds up the structure of the system.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">IntegrateKxKy</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function integrates over <script type="math/tex">k_x</script> and <script type="math/tex">k_y</script> based on the integral properties set by the user. So the function can only be called after the <script type="math/tex">k_x</script> and <script type="math/tex">k_y</script> integrals are configured, and the system is initialized.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">IntegrateKxKyMPI</span><span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>rank: [int], the rank of the thread.</li>
<li>size: [int], the total size of the MPI run.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function can only be called during MPI. For an example of a funtion call,  please refer to <a href="../../Examples/MPI/">MPI example</a>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">GetNumOfOmega</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: [int], the number of total omega points computed in the simulation.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">GetPhi</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: [table of double], the <script type="math/tex">\Phi(\omega)</script> values obtained from the simulation.</p>
</li>
<li>
<p>Note: can only be called after <script type="math/tex">k_x</script> and <script type="math/tex">k_y</script> are integrated.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">GetOmega</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: [table of double], the omega values computed in the simulation.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">GetEpsilon</span><span class="p">(</span><span class="n">omega</span> <span class="n">index</span><span class="p">,</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">})</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>omega index: [int], the index of the omega value where <script type="math/tex">\epsilon</script> is evaluated.  To be consistent with Lua, this index starts from <script type="math/tex">1</script>.</li>
<li>{x, y, z}: [double table], the real space position where the index is evaluated, in SI unit</li>
</ol>
</li>
<li>
<p>Output: value of epsilon with length <script type="math/tex">10</script>, in the form of
  <code>eps_xx_r, eps_xx_i, eps_xy_r, eps_xy_i, eps_yx_r, eps_yx_i,ã€€eps_yy_r, eps_yy_i, eps_zz_r, eps_zz_i</code>
  These are computed by reconstruction of the Fourier series, so won't be the same as the exact dielectric function.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">GetPhiAtKxKy</span><span class="p">(</span><span class="n">omega</span> <span class="n">index</span><span class="p">,</span> <span class="n">kx</span><span class="p">,</span> <span class="n">ky</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>omega index: [int], the index of the omega value where <script type="math/tex">\Phi(\omega[\text{index}], k_x, k_y)</script> is evaluated.  To be consistent with Lua, this index starts from <script type="math/tex">1</script>.</li>
<li>kx: [double], the <script type="math/tex">k_x</script> value where <script type="math/tex">\Phi(\omega[\text{index}], k_x, k_y)</script> is evaluated. It is a normalized value by <script type="math/tex">\omega[\text{index}]/c</script>.</li>
<li>ky: [double], the <script type="math/tex">k_y</script> value where <script type="math/tex">\Phi(\omega[\text{index}], k_x, k_y)</script> is evaluated. It is a normalized value by <script type="math/tex">\omega[\text{index}]/c</script>.</li>
</ol>
</li>
<li>
<p>Output: [double], the value of <script type="math/tex">\Phi(\omega, k_x, k_y)</script>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">OutputSysInfo</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: the function prints out a system description to screen.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">OutputLayerPatternRealization</span><span class="p">(</span><span class="n">omega</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Nu</span><span class="p">,</span> <span class="n">Nv</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>


<ul>
<li>
<p>Arguments:</p>
<ol>
<li>omega index: [int], the index of the omega value that the dielectric is evaluated.   To be consistent with Lua, this index starts from <script type="math/tex">1</script>.</li>
<li>name: [string], the name of the layer.</li>
<li>Nu: [int], number of points in x direction in one periodicity.</li>
<li>Nv: [int], number of points in y direction in one periodicity.</li>
<li>filename: [string], optional. If not given, then the epsilon values will be printed to standard output.</li>
</ol>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: the epsilon format will be the same as the function <code>GetEpsilon</code>.</p>
</li>
</ul>
<p>Also, MESH provides some options for printing intermediate information and methods for Fourier transform of the dielectric.</p>
<div class="codehilite"><pre><span></span><span class="n">OptOnlyComputeTE</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: with this function, the package only computes flux contributed from TE mode.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">OptOnlyComputeTM</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: with this function, the package only computes flux contributed from TM mode.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">OptPrintIntermediate</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>Arguments: None</p>
</li>
<li>
<p>Output: None</p>
</li>
<li>
<p>Note: this function prints intermediate <script type="math/tex">\Phi(\omega, k_x, k_y)</script> when function <code>IntegrateKxKy()</code> or <code>IntegrateKxKyMPI(rank, size)</code> is called. The output format is
a list of "<script type="math/tex">\omega</script>
<script type="math/tex">k_x</script>
<script type="math/tex">k_y</script>
<script type="math/tex">\Phi(\omega, k_x, k_y)</script>", where <script type="math/tex">k_x</script> and <script type="math/tex">k_y</script> are values normalized to <script type="math/tex">\omega/c</script>.</p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In MPI this function is not guaranteed to be atomic, meaning the printed output might be messed because each process is writing its own value to the screen. However for OpenMP, there is no such problem.</p>
</div>
<p>MESH also provides physics constants to facilitate computation. The constant object can be initiated by</p>
<div class="codehilite"><pre><span></span><span class="n">constant</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">()</span>
</pre></div>


<p>The supported constants are (all in SI unit)</p>
<ul>
<li>constant.pi: the value of <script type="math/tex">\pi</script>.</li>
<li>constant.k_B: the value of <script type="math/tex">k_B</script>.</li>
<li>constant.eps_0: the value of <script type="math/tex">\epsilon_0</script>.</li>
<li>constant.mu_0: the value of <script type="math/tex">\mu_0</script>.</li>
<li>constant.m_e: the value of <script type="math/tex">m_e</script>, i.e. the mass of an electron.</li>
<li>constant.eV: electron volt in Joules.</li>
<li>constant.h: the value of Planck's constant.</li>
<li>constant.h_bar: the value of the reduced Planck's constant.</li>
<li>constant.c_0: the speed of light.</li>
<li>constant.q: the value of <script type="math/tex">q</script>, i.e. magnitude of electron charge.</li>
<li>constant.sigma: the value of <script type="math/tex">\sigma</script>, i.e. Stefan-Boltzmann constant.</li>
</ul>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../installation/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Installation
              </span>
            </div>
          </a>
        
        
          <a href="../planar/" title="SimulationPlanar" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                SimulationPlanar
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 Kaifeng Chen
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/kfrancischen" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.linkedin.com/in/kaifeng-chen-b37a2b69/" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-c6f9af8d0c.js"></script>
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../mathjaxhelper.js"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-40321028-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>